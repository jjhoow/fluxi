{% extends "base.html" %}

{% block title %}Estatísticas - {{ rag.nome }} - Fluxi.IA{% endblock %}

{% block content %}
<div style="margin-bottom: 2rem;">
    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
        <a href="/rags" style="width: 48px; height: 48px; border-radius: 10px; background: #f3f4f6; display: flex; align-items: center; justify-content: center; text-decoration: none; color: #6b7280;">
            <i class="fas fa-arrow-left"></i>
        </a>
        <div style="flex: 1; min-width: 0;">
            <h1 class="title is-3" style="margin-bottom: 0.5rem !important; line-height: 1.2; color: #1f2937;">
                <i class="fas fa-chart-line" style="color: #8b5cf6;"></i> Estatísticas
            </h1>
            <p class="subtitle is-6" style="color: #6b7280; margin-bottom: 0 !important; line-height: 1.4;">
                RAG: <strong>{{ rag.nome }}</strong>
            </p>
        </div>
    </div>
</div>

<!-- Resumo Geral -->
<div class="columns is-multiline" style="margin-bottom: 2rem;">
    <div class="column is-3">
        <div class="box" style="text-align: center; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none;">
            <div style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;">
                {{ stats.chunks.total if stats.chunks else 0 }}
            </div>
            <div style="font-size: 0.9rem; opacity: 0.9;">Total de Chunks</div>
        </div>
    </div>
    <div class="column is-3">
        <div class="box" style="text-align: center; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; border: none;">
            <div style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;">
                {{ rag.provider }}
            </div>
            <div style="font-size: 0.9rem; opacity: 0.9;">Provider</div>
        </div>
    </div>
    <div class="column is-3">
        <div class="box" style="text-align: center; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; border: none;">
            <div style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;">
                {{ rag.chunk_size }}
            </div>
            <div style="font-size: 0.9rem; opacity: 0.9;">Chunk Size</div>
        </div>
    </div>
    <div class="column is-3">
        <div class="box" style="text-align: center; background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); color: white; border: none;">
            <div style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;">
                {{ rag.top_k }}
            </div>
            <div style="font-size: 0.9rem; opacity: 0.9;">Top K</div>
        </div>
    </div>
</div>

<!-- Informações do RAG -->
<div class="box" style="margin-bottom: 2rem;">
    <h2 class="title is-5" style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid #e5e7eb;">
        <i class="fas fa-info-circle" style="color: #10b981;"></i> Informações do RAG
    </h2>
    
    <div class="columns">
        <div class="column is-6">
            <div style="space-y: 1rem;">
                <div>
                    <div style="font-weight: 600; color: #1f2937; margin-bottom: 0.25rem;">Nome</div>
                    <div style="color: #6b7280;">{{ rag.nome }}</div>
                </div>
                <div>
                    <div style="font-weight: 600; color: #1f2937; margin-bottom: 0.25rem;">Provider</div>
                    <div style="color: #6b7280; text-transform: capitalize;">{{ rag.provider }}</div>
                </div>
                <div>
                    <div style="font-weight: 600; color: #1f2937; margin-bottom: 0.25rem;">Modelo</div>
                    <div style="color: #6b7280;">{{ rag.modelo_embed }}</div>
                </div>
                <div>
                    <div style="font-weight: 600; color: #1f2937; margin-bottom: 0.25rem;">Status</div>
                    <div style="color: #6b7280;">
                        {% if rag.treinado %}
                        <span style="color: #10b981; font-weight: 600;">✓ Treinado</span>
                        {% else %}
                        <span style="color: #f59e0b; font-weight: 600;">⚠ Não Treinado</span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <div class="column is-6">
            <div style="space-y: 1rem;">
                <div>
                    <div style="font-weight: 600; color: #1f2937; margin-bottom: 0.25rem;">Chunk Size</div>
                    <div style="color: #6b7280;">{{ rag.chunk_size }} caracteres</div>
                </div>
                <div>
                    <div style="font-weight: 600; color: #1f2937; margin-bottom: 0.25rem;">Chunk Overlap</div>
                    <div style="color: #6b7280;">{{ rag.chunk_overlap }} caracteres</div>
                </div>
                <div>
                    <div style="font-weight: 600; color: #1f2937; margin-bottom: 0.25rem;">Top K</div>
                    <div style="color: #6b7280;">{{ rag.top_k }} resultados</div>
                </div>
                <div>
                    <div style="font-weight: 600; color: #1f2937; margin-bottom: 0.25rem;">Score Threshold</div>
                    <div style="color: #6b7280;">{{ rag.score_threshold or 'Não definido' }}</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Botões de Ação -->
<div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-top: 2rem;">
    <a href="/rags/{{ rag.id }}/texto" class="button is-medium" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; border: none; font-weight: 600; border-radius: 8px; padding: 0.75rem 2rem;">
        <span class="icon"><i class="fas fa-keyboard"></i></span>
        <span>Gerenciar Texto</span>
    </a>
    <a href="/rags/{{ rag.id }}/testar" class="button is-medium" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; font-weight: 600; border-radius: 8px; padding: 0.75rem 2rem;">
        <span class="icon"><i class="fas fa-search"></i></span>
        <span>Testar Busca</span>
    </a>
    <a href="/rags/{{ rag.id }}/chunks" class="button is-medium" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; border: none; font-weight: 600; border-radius: 8px; padding: 0.75rem 2rem;">
        <span class="icon"><i class="fas fa-puzzle-piece"></i></span>
        <span>Ver Chunks</span>
    </a>
    <a href="/rags/{{ rag.id }}/editar" class="button is-medium" style="border-radius: 8px; font-weight: 600; padding: 0.75rem 2rem;">
        <span class="icon"><i class="fas fa-edit"></i></span>
        <span>Editar RAG</span>
    </a>
    <a href="/rags" class="button is-medium" style="border-radius: 8px; font-weight: 600; padding: 0.75rem 2rem;">
        <span class="icon"><i class="fas fa-arrow-left"></i></span>
        <span>Voltar</span>
    </a>
</div>

{% endblock %}
